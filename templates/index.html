{% extends 'layout.html' %}

{% block title %}Home - Kuizu{% endblock %}

{% block content %}
<div class="container py-5">
    <!-- Hero Section with Gradient Background -->
    <div class="row mb-5">
        <div class="col-lg-10 mx-auto text-center">
            <div class="p-5 rounded-4 bg-gradient shadow-lg" style="background: linear-gradient(135deg, #6a11cb 0%, #2575fc 100%);">
                <h1 class="display-4 fw-bold mb-3 text-white">Welcome to <span class="welcome" style="color: #ffe259;">Kuizu!</span></h1>
                <p class="lead text-white mb-4">Hello, {{user.username}}! Ready to challenge your knowledge today?</p>
                <div class="d-grid gap-2 d-sm-flex justify-content-sm-center">
                    <a href="{{ url_for('dashboard') }}" class="btn btn-light btn-lg px-4 gap-3 shadow-sm">
                        <i class="bi bi-play-circle me-2"></i> Start Quiz
                    </a>
                </div>
            </div>
        </div>
    </div>

    <!-- Features Section with Hover Effects -->
    <div class="row row-cols-1 row-cols-md-3 g-4 mb-5">
        <div class="col">
            <div class="card h-100 border-0 shadow-sm feature-card">
                <div class="card-body text-center p-4">
                    <div class="feature-icon bg-primary bg-gradient text-white rounded-circle mb-3">
                        <i class="bi bi-lightning-charge"></i>
                    </div>
                    <h5 class="card-title">Quick Learning</h5>
                    <p class="card-text">Test your knowledge with our carefully crafted quizzes designed to challenge and educate.</p>
                </div>
            </div>
        </div>
        <div class="col">
            <div class="card h-100 border-0 shadow-sm feature-card">
                <div class="card-body text-center p-4">
                    <div class="feature-icon bg-success bg-gradient text-white rounded-circle mb-3">
                        <i class="bi bi-graph-up"></i>
                    </div>
                    <h5 class="card-title">Track Progress</h5>
                    <p class="card-text">Monitor your performance and see your improvement over time with detailed analytics.</p>
                </div>
            </div>
        </div>
        <div class="col">
            <div class="card h-100 border-0 shadow-sm feature-card">
                <div class="card-body text-center p-4">
                    <div class="feature-icon bg-info bg-gradient text-white rounded-circle mb-3">
                        <i class="bi bi-trophy"></i>
                    </div>
                    <h5 class="card-title">Earn Achievements</h5>
                    <p class="card-text">Complete quizzes and earn badges and certificates for your accomplishments.</p>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Quizzes Section -->
    <div class="row">
        <!-- Ongoing Quizzes -->
        <div class="col-12 mb-5">
            <div class="d-flex align-items-center mb-4">
                <div class="bg-primary rounded-circle p-2 me-3">
                    <i class="bi bi-hourglass-split text-white"></i>
                </div>
                <h2 class="fw-bold m-0">Ongoing Quizzes</h2>
            </div>
            
            {% if ongoing_quizzes %}
                <div class="row row-cols-1 row-cols-md-2 g-4">
                    {% for quiz in ongoing_quizzes %}
                    <div class="col">
                        <div class="card h-100 border-0 shadow-sm quiz-card">
                            <div class="card-body p-4">
                                <div class="d-flex justify-content-between mb-3">
                                    <h5 class="card-title fw-bold mb-0">{{ quiz.title }}</h5>
                                    <span class="badge bg-danger">LIVE</span>
                                </div>
                                <p class="card-text text-muted">{{ quiz.description }}</p>
                                
                                <!-- Chapter display -->
                                {% if ongoing_quizzes_chapters[quiz.id] %}
                                <div class="mb-3">
                                    <h6 class="mb-2 text-primary">Chapters:</h6>
                                    <div class="d-flex flex-wrap gap-2">
                                        {% for chapter in ongoing_quizzes_chapters[quiz.id] %}
                                        <span class="badge bg-light text-dark p-2">
                                            <i class="bi bi-journal-text me-1"></i> {{ chapter.title }}
                                        </span>
                                        {% endfor %}
                                    </div>
                                </div>
                                {% endif %}
                                
                                <hr>
                                <div class="d-flex justify-content-between align-items-center">
                                    <div>
                                        <span class="badge bg-light text-dark">
                                            <i class="bi bi-clock me-1"></i> {{ quiz.time_limit or 'No limit' }}{% if quiz.time_limit %} min{% endif %}
                                        </span>
                                        <span class="badge bg-light text-dark ms-2">
                                            <i class="bi bi-award me-1"></i> {{ quiz.passing_score or 'N/A' }}{% if quiz.passing_score %}%{% endif %}
                                        </span>
                                    </div>
                                    <a href="{{ url_for('view_quiz', quiz_id=quiz.id) }}" class="btn btn-primary">
                                        <i class="bi bi-play-fill me-1"></i> Start Quiz
                                    </a>
                                </div>
                            </div>
                        </div>
                    </div>
                    {% endfor %}
                </div>
            {% else %}
                <div class="card border-0 shadow-sm p-4">
                    <div class="text-center py-4">
                        <i class="bi bi-journal-x" style="font-size: 3rem; color: #ddd;"></i>
                        <p class="text-muted mt-3 mb-0">No ongoing quizzes available at the moment.</p>
                        <p class="small text-muted">Check back later for new challenges!</p>
                    </div>
                </div>
            {% endif %}
        </div>

        <!-- Upcoming Quizzes -->
        <div class="col-12">
            <div class="d-flex align-items-center mb-4">
                <div class="bg-success rounded-circle p-2 me-3">
                    <i class="bi bi-calendar-event text-white"></i>
                </div>
                <h2 class="fw-bold m-0">Upcoming Quizzes</h2>
            </div>
            
            {% if upcoming_quizzes %}
                <div class="row row-cols-1 row-cols-md-2 g-4">
                    {% for quiz in upcoming_quizzes %}
                    <div class="col">
                        <div class="card h-100 border-0 shadow-sm quiz-card">
                            <div class="card-body p-4">
                                <div class="d-flex justify-content-between mb-3">
                                    <h5 class="card-title fw-bold mb-0">{{ quiz.title }}</h5>
                                    <span class="badge bg-warning text-dark">UPCOMING</span>
                                </div>
                                <p class="card-text text-muted">{{ quiz.description }}</p>
                                
                                <!-- Chapter display -->
                                {% if upcoming_quizzes_chapters[quiz.id] %}
                                <div class="mb-3">
                                    <h6 class="mb-2 text-primary">Chapters:</h6>
                                    <div class="d-flex flex-wrap gap-2">
                                        {% for chapter in upcoming_quizzes_chapters[quiz.id] %}
                                        <span class="badge bg-light text-dark p-2">
                                            <i class="bi bi-journal-text me-1"></i> {{ chapter.title }}
                                        </span>
                                        {% endfor %}
                                    </div>
                                </div>
                                {% endif %}
                                
                                <hr>
                                <div class="d-flex justify-content-between align-items-center">
                                    <div>
                                        <span class="badge bg-light text-dark">
                                            <i class="bi bi-calendar-date me-1"></i>
                                            {{ quiz.start_time.strftime('%d %b, %Y') }}
                                        </span>
                                        <span class="badge bg-light text-dark ms-2">
                                            <i class="bi bi-clock me-1"></i> {{ quiz.time_limit or 'No limit' }}{% if quiz.time_limit %} min{% endif %}
                                        </span>
                                    </div>
                                    <a href="{{ url_for('view_quiz', quiz_id=quiz.id) }}" class="btn btn-outline-primary">
                                        <i class="bi bi-info-circle me-1"></i> Details
                                    </a>
                                </div>
                            </div>
                        </div>
                    </div>
                    {% endfor %}
                </div>
            {% else %}
                <div class="card border-0 shadow-sm p-4">
                    <div class="text-center py-4">
                        <i class="bi bi-calendar-x" style="font-size: 3rem; color: #ddd;"></i>
                        <p class="text-muted mt-3 mb-0">No upcoming quizzes scheduled at the moment.</p>
                        <p class="small text-muted">New quizzes are added regularly!</p>
                    </div>
                </div>
            {% endif %}
        </div>
    </div>
</div>

<style>
/* Custom styles for the page */
.feature-icon {
    width: 4rem;
    height: 4rem;
    font-size: 2rem;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    transition: transform 0.3s ease;
}

.feature-card:hover .feature-icon {
    transform: scale(1.1);
}

.feature-card {
    transition: transform 0.3s ease, box-shadow 0.3s ease;
}

.feature-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 10px 20px rgba(0,0,0,0.1) !important;
}

.quiz-card {
    transition: transform 0.3s ease, box-shadow 0.3s ease;
    border-radius: 0.75rem;
    overflow: hidden;
}

.quiz-card:hover {
    transform: translateY(-3px);
    box-shadow: 0 8px 16px rgba(0,0,0,0.1) !important;
}

/* Custom styling for badges */
.badge {
    font-weight: normal;
    letter-spacing: 0.5px;
    border-radius: 20px;
    padding: 0.35em 0.65em;
}
</style>
{% endblock %}